(function(b,c){var d={ValidationPass:true,fields:{"0":{tag:"input",container:"#card_number_content",options:{id:"card-number",name:"card-number","class":"card-number",value:""}},"1":{tag:"input",container:"#card_expm_content",options:{id:"card-expm",name:"card-expm","class":"card-expm",maxlength:"2",value:"",placeholder:"MM"}},"2":{tag:"input",container:"#card_expy_content",options:{id:"card-expy",name:"card-expy","class":"card-expy",maxlength:"4",value:"",placeholder:"RR"}},"3":{tag:"input",container:"#card_cvv_content",options:{id:"card-cvv",name:"card-cvv","class":"card-cvv",maxlength:"4",value:""}},"4":{tag:"input",container:"#card_customer_id",options:{"class":"customer-id",value:"${buyer.hashId}"}}},init:function(g,f,h,e){this.showPageLoading();c.ajax({cache:false,type:"GET",url:f,dataType:"script",complete:function(){c.ajax({cache:false,type:"GET",url:h,dataType:"script",complete:function(){c.ajax({cache:false,type:"GET",url:e,dataType:"script",complete:function(){d.onSuccessfulJsLoadBeforeFormBuild();switch(d.tokenPresent.storedTokenPresent){case"true":d.buildStoredForm();break;default:d.buildForm();break}d.onSuccessfulJsLoadAfterFormBuild();d.hidePageLoading()},error:function(j){d.hidePageLoading();d.showCardAddError()}})},error:function(j){d.hidePageLoading();d.showCardAddError()}})},error:function(j){d.hidePageLoading();d.showCardAddError()}})},checkForErrorMessage:function(){var e=c("#message_commit").css("display");if(e&&e!="none"){return true}else{return false}},showCardAddError:function(){if(this.checkForErrorMessage()==false){c("#message_commit").show();c("#error_message_content").html(cardAddError)}c("html, body").animate({scrollTop:0},"fast")},showPageLoading:function(){},hidePageLoading:function(){},onSuccessfulJsLoadBeforeFormBuild:function(){},onSuccessfulJsLoadAfterFormBuild:function(){},tokenPresent:{storedTokenPresent:"",maskedCardNumber:"",cardExpirationMonth:function(){},cardExpirationYear:""},processTokenCreateResponseSuccess:function(){},processTokenCreateResponseFailureBefore:function(){},processTokenCreateResponseFailureAfter:function(){},processTokenCreateResponse:function(e){if(e.status.statusCode=="SUCCESS"){this.processTokenCreateResponseSuccess()}else{this.processTokenCreateResponseFailureBefore();c("#white_overlay").hide();switch(e.status.code){case"4000":c("#error_number").text(errorCard[2]);c("#error_number_container").show();break;case"4001":c("#error_date").text(errorCard[5]);c("#error_date_container").show();break;case"4002":c("#error_date").text(errorCard[6]);c("#error_date_container").show();break;case"4003":c("#error_cvv").text(errorCard[4]);c("#error_cvv_container").show();break;case"4004":c("#error_number").text(errorCard[3]);c("#error_number_container").show();break;default:d.showCardAddError();break}this.processTokenCreateResponseFailureAfter()}},tokenCreate:function(){c("#white_overlay").show();this.tokenCreateBeforeSend();OpenPayU.merchantId=unregisteredCardPosOwner;c(".card-number").val(OpenPayU.Validation.normalize(c(".card-number").val()));OpenPayU.Token.create({},this.tokenCreateAfterSend)},tokenCreateBeforeSend:function(){},tokenCreateAfterSend:function(e){},buildForm:function(){rq="TokenCreateRequest";version=OpenPayU.version;var e=OpenPayU.model[version][rq].mandatory.length;var f="";for(f=0;f<=(e-1);f++){OpenPayU.Builder.createHtmlElement(this.fields[f].tag,this.fields[f].container,this.fields[f].options);this.buildFormAfterFieldCreation(this.fields[f])}c("#normalCardInfoTable").show();c("#singleCardInfoTable").hide();this.buildFormSetCss();c("#card-number").keypress(cardUrlImg,function(){d.icoShow(cardUrlIco)});c("#card-number").change(cardUrlImg,function(){d.icoShow(cardUrlIco)});c("#card-number").keyup(function(){revalidateCardOnSummary()});c("#card-expm").keyup(function(){revalidateCardOnSummary()});c("#card-expy").keyup(function(){revalidateCardOnSummary()});c("#card-cvv").keyup(function(){revalidateCardOnSummary()})},buildFormAfterFieldCreation:function(){},buildFormSetCss:function(){},buildStoredForm:function(){c("#normalCardInfoTable").hide();c("#singleCardInfoTable").show();this.buildStoredFormSetCss();c("#secondCol1").html('<span class="gwt-InlineLabel">'+this.tokenPresent.maskedCardNumber+"</span>");c("#secondCol2").html('<span class="gwt-InlineLabel">'+this.tokenPresent.cardExpirationYear+"-"+this.tokenPresent.cardExpirationMonth()+"</span>");this.buildStoredFormShowCardImg();this.createEnableLabel()},buildStoredFormSetCss:function(){},buildStoredFormShowCardImg:function(){},getCardVisa:function(e){a="";reg=new RegExp("^[4]");if(reg.test(e)){a="true"}else{a="false"}return a},getCardMaster:function(e){a="";reg=new RegExp("^[5]");if(reg.test(e)){a="true"}else{a="false"}return a},icoShow:function(e){var f=c("#card-number").val();if(this.getCardVisa(f)=="true"){c("#imgCard").html(e[0])}if(this.getCardMaster(f)=="true"){c("#imgCard").html(e[1])}if(this.getCardVisa(f)=="false"&&this.getCardMaster(f)=="false"){c("#imgCard").html("")}c("#card_saved_chkbox").show()},imgShow:function(f){var e=this.tokenPresent.maskedCardNumber;if(this.getCardVisa(e)=="true"){c("#"+f).attr({src:cardUrlImg+"/bank/on-visa.jpg"})}if(this.getCardMaster(e)=="true"){c("#"+f).attr({src:cardUrlImg+"/bank/on-mastercard.jpg"})}if(this.getCardVisa(e)=="false"&&this.getCardMaster(e)=="false"){c("#"+f).attr({src:cardUrlImg+"/bank/on-c.gif"})}},padWithZeroes:function(f,e){var g=""+f;while(g.length<e){g="0"+g}return g},recalculate:function(){},checkProcess:function(){if(c("#card_container").css("display")!="none"){if(c("#normalCardInfoTable").css("display")!="none"){return true}else{return false}}else{return false}},checkForMethod:function(){},validateForm:function(){var f="TokenCreateRequest";var g=OpenPayU.Validation.validate(f,"2.0");if(g.length>0){d.showCardAddError()}var e=OpenPayU.Token.validate(f,"2.0");this.showErrorMessages(e);this.validateFormAnimation();if(g.length==0&&e.length==0){return true}return false},validateFormAnimation:function(){if(this.ValidationPass==true){this.ValidationPass=false;var e=this.validateFormAnimationCalculateHeight();var h=c("#error_number_container").css("display");var g=c("#error_date_container").css("display");var f=c("#error_cvv_container").css("display");i=0;if(h!="none"){i++}if(g!="none"){i++}if(f!="none"){i++}diff=e-i*30;if(diff!=0){c("#card_style").animate({"min-height":"-="+diff+"px"},100,function(){this.ValidationPass=true})}}return true},validateFormAnimationCalculateHeight:function(){},checkForError:function(e,h){var f=e.length-1;for(var g=0;g<=f;g++){if(e[g]==h){return true}}return false},fieldNamesForValidation:{cardNumber:".card-number",cardCvv:".card-cvv",cardExpirationMonth:".card-expm",cardExpirationYear:".card-expy"},showErrorMessages:function(e){var f=e.length;if(f>0){var g=f-1;for(var h=0;h<=g;h++){if(this.checkForError(e,this.fieldNamesForValidation.cardExpirationYear)){if(e[h]==this.fieldNamesForValidation.cardExpirationYear){c("#error_date").text(errorCard[0]);c("#error_date_container").show()}}else{c("#error_date_container").hide()}if(this.checkForError(e,this.fieldNamesForValidation.cardExpirationMonth)){if(e[h]==this.fieldNamesForValidation.cardExpirationMonth){c("#error_date").text(errorCard[0]);c("#error_date_container").show()}}else{c("#error_date_container").hide()}if(this.checkForError(e,this.fieldNamesForValidation.cardNumber)){if(e[h]==this.fieldNamesForValidation.cardNumber){c("#error_number").text(errorCard[0]);c("#error_number_container").show()}}else{c("#error_number_container").hide()}if(this.checkForError(e,this.fieldNamesForValidation.cardCvv)){if(e[h]==this.fieldNamesForValidation.cardCvv){c("#error_cvv").text(errorCard[4]);c("#error_cvv_container").show()}}else{c("#error_cvv_container").hide()}if(this.checkForError(e,"Date has expired")){if(e[h]=="Date has expired"){c("#error_date").text(errorCard[3]);c("#error_date_container").show()}}else{c("#error_date_container").hide()}if(this.checkForError(e,"Card number is invalid")){if(e[h]=="Card number is invalid"){c("#error_number").text(errorCard[2]);c("#error_number_container").show()}}else{c("#error_number_container").hide()}}}else{c("#error_cvv_container").hide();c("#error_date_container").hide();c("#error_number_container").hide()}},clearValidationMessages:function(){c("#error_number_container").hide();c("#error_date_container").hide();c("#error_cvv_container").hide();cardWasValidated=false},bodyInit:function(e){},createEnableLabel:function(){if(c("#card-enable-content").length==0){OpenPayU.Builder.createHtmlElement("div","#card_container",{id:"card-enable-content"});OpenPayU.Builder.createHtmlElement("span","#card-enable-content",{id:"card-enable-link",href:"#"}).text(enableBtn);this.createEnableLabelSetCss();c("#card-enable-link").live("click",function(){d.createNewRequest()})}else{c("#card-enable-link").show()}},createEnableLabelSetCss:function(){},hideEnableLabel:function(){c("#card-enable-link").hide()},createNewRequest:function(){this.buildForm();this.clearCardNumber();var e=c("#card_style img").attr("id");c("#"+e).attr({src:cardUrlImg+"/bank/on-c.gif"});this.hideEnableLabel()},clearCardNumber:function(){c("#card-number").val("");c("#card-number").unmask();c("#card-number").mask("?9999 9999 9999 9999 999",{placeholder:" "})}};b.UnregisteredCardJsLib=d}(window,jQuery));